<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nclist-cpp: Nested containment lists in C++</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nclist-cpp
   </div>
   <div id="projectbrief">C++ implementation of nested containment lists</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Nested containment lists in C++ </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2github_2workspace_2README"></a></p>
<p><img src="https://github.com/LTLA/nclist/actions/workflows/run-tests.yaml/badge.svg" alt="Unit tests" style="pointer-events: none;" class="inline"/> <img src="https://github.com/LTLA/nclist/actions/workflows/doxygenate.yaml/badge.svg" alt="Documentation" style="pointer-events: none;" class="inline"/> <a href="https://codecov.io/gh/LTLA/nclist"><img src="https://codecov.io/gh/LTLA/nclist/branch/master/graph/badge.svg?token=GByG4StuqU" alt="Codecov" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>This library implements the <a href="https://doi.org/10.1093/bioinformatics/btl647">nested containment list (NCList)</a> algorithm for interval queries. Specifically, the aim is to find all "subject" ranges that overlap a "query" range, which is a common task when analyzing genomics data. The interface and capabilities of this library are based on the <code>findOverlaps()</code> function from the <a href="https://bioconductor.org/packages/IRanges"><b>IRanges</b></a> R package. We support overlaps with a maximum gap or minimum overlap, as well as overlaps of different types - matching starts/ends, within/extends, etc.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Quick start</h1>
<p>Given an array of starts/ends for the subject ranges, we build the nested containment list:</p>
<div class="fragment"><div class="line"><span class="comment">// The i-th subject interval is defined as &#39;[starts[i], ends[i])&#39;.</span></div>
<div class="line"><span class="comment">// Note that the end is not inclusive.</span></div>
<div class="line">std::vector&lt;int&gt; starts { 5, 10, 20 };</div>
<div class="line">std::vector&lt;int&gt; ends   { 8, 25, 30 };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> subjects = <a class="code hl_function" href="namespacenclist.html#af017ae50c229346e3cf8e41599fbb5c0">nclist::build</a>(3, starts.data(), ends.data());</div>
<div class="ttc" id="anamespacenclist_html_af017ae50c229346e3cf8e41599fbb5c0"><div class="ttname"><a href="namespacenclist.html#af017ae50c229346e3cf8e41599fbb5c0">nclist::build</a></div><div class="ttdeci">Nclist&lt; Index_, Position_ &gt; build(Index_ num_subset, const Index_ *subset, const Position_ *starts, const Position_ *ends)</div><div class="ttdef"><b>Definition</b> build.hpp:209</div></div>
</div><!-- fragment --><p>Then we check for overlaps with our query range:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsAnyWorkspace.html">nclist::OverlapsAnyWorkspace&lt;int&gt;</a> workspace;</div>
<div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsAnyParameters.html">nclist::OverlapsAnyParameters&lt;int&gt;</a> params;</div>
<div class="line">std::vector&lt;int&gt; matches;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Checking for overlaps to `[6, 16)`.</span></div>
<div class="line"><span class="comment">// &#39;matches&#39; is filled with the indices of the matching subject range.</span></div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 6, 16, params, workspace, matches);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Performing another query.</span></div>
<div class="line"><span class="comment">// The workspace is re-used to avoid reallocation of internal structures.</span></div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 25, 30, params, workspace, matches);</div>
<div class="ttc" id="anamespacenclist_html_ade7d2e27bd85d84a0cd210d3fcce7335"><div class="ttname"><a href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a></div><div class="ttdeci">void overlaps_any(const Nclist&lt; Index_, Position_ &gt; &amp;subject, Position_ query_start, Position_ query_end, const OverlapsAnyParameters&lt; Position_ &gt; &amp;params, OverlapsAnyWorkspace&lt; Index_ &gt; &amp;workspace, std::vector&lt; Index_ &gt; &amp;matches)</div><div class="ttdef"><b>Definition</b> overlaps_any.hpp:244</div></div>
<div class="ttc" id="astructnclist_1_1OverlapsAnyParameters_html"><div class="ttname"><a href="structnclist_1_1OverlapsAnyParameters.html">nclist::OverlapsAnyParameters</a></div><div class="ttdoc">Parameters for overlaps_any().</div><div class="ttdef"><b>Definition</b> overlaps_any.hpp:48</div></div>
<div class="ttc" id="astructnclist_1_1OverlapsAnyWorkspace_html"><div class="ttname"><a href="structnclist_1_1OverlapsAnyWorkspace.html">nclist::OverlapsAnyWorkspace</a></div><div class="ttdoc">Workspace for overlaps_any().</div><div class="ttdef"><b>Definition</b> overlaps_any.hpp:27</div></div>
</div><!-- fragment --><p>Check out the <a href="https://ltla.github.io/nclist-cpp">reference documentation</a> for more details.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Setting parameters</h1>
<p>Say we only want to report overlaps where the length of the overlapping subrange is not below some threshold. We can do so with the <code>min_overlaps=</code> parameter:</p>
<div class="fragment"><div class="line">params.min_overlaps = 10;</div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 20, 30, params, workspace, matches);</div>
</div><!-- fragment --><p>We can also detect "overlaps" where the query and subject ranges are separated by a gap that is no greater than some threshold:</p>
<div class="fragment"><div class="line"><span class="comment">// &#39;max_gap = 0&#39; means that contiguous ranges are considered &quot;overlapping&quot;.</span></div>
<div class="line">params.<a class="code hl_variable" href="structnclist_1_1OverlapsAnyParameters.html#a3cbcc727a8b0a7901edf133658e083a0">max_gap</a> = 0;</div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 1, 5, params, workspace, matches);</div>
<div class="line"> </div>
<div class="line">params.<a class="code hl_variable" href="structnclist_1_1OverlapsAnyParameters.html#a3cbcc727a8b0a7901edf133658e083a0">max_gap</a> = 10;</div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 40, 50, params, workspace, matches);</div>
<div class="ttc" id="astructnclist_1_1OverlapsAnyParameters_html_a3cbcc727a8b0a7901edf133658e083a0"><div class="ttname"><a href="structnclist_1_1OverlapsAnyParameters.html#a3cbcc727a8b0a7901edf133658e083a0">nclist::OverlapsAnyParameters::max_gap</a></div><div class="ttdeci">std::optional&lt; Position_ &gt; max_gap</div><div class="ttdef"><b>Definition</b> overlaps_any.hpp:56</div></div>
</div><!-- fragment --><p>In some cases, we only want to determine if any overlap exists, without concern for the identity of the overlapping subject ranges. This can be achieved with the <code>quit_on_first=</code> parameter, which will return upon finding the first overlapping range for greater efficiency.</p>
<div class="fragment"><div class="line">params.<a class="code hl_variable" href="structnclist_1_1OverlapsAnyParameters.html#a8f06f6eff0a683f5cb0e32060bd5f5f3">quit_on_first</a> = <span class="keyword">true</span>;</div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 0, 50, params, workspace, matches);</div>
<div class="line">matches.empty();</div>
<div class="ttc" id="astructnclist_1_1OverlapsAnyParameters_html_a8f06f6eff0a683f5cb0e32060bd5f5f3"><div class="ttname"><a href="structnclist_1_1OverlapsAnyParameters.html#a8f06f6eff0a683f5cb0e32060bd5f5f3">nclist::OverlapsAnyParameters::quit_on_first</a></div><div class="ttdeci">bool quit_on_first</div><div class="ttdef"><b>Definition</b> overlaps_any.hpp:68</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Overlap types</h1>
<p>The <code>overlaps_any()</code> function will look for any overlaps between the query and subject ranges. However, other functions can also be used to report different types of overlaps. Perhaps we want to consider overlaps where the query range lies "within" (i.e., is a subrange of) a subject range:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsWithinWorkspace.html">nclist::OverlapsWithinWorkspace&lt;int&gt;</a> wworkspace;</div>
<div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsWithinParameters.html">nclist::OverlapsWithinParameters&lt;int&gt;</a> wparams;</div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#a17c768a993d651cfa8bd50080cfdd913">nclist::overlaps_within</a>(subjects, 20, 28, wparams, wworkspace, matches);</div>
<div class="ttc" id="anamespacenclist_html_a17c768a993d651cfa8bd50080cfdd913"><div class="ttname"><a href="namespacenclist.html#a17c768a993d651cfa8bd50080cfdd913">nclist::overlaps_within</a></div><div class="ttdeci">void overlaps_within(const Nclist&lt; Index_, Position_ &gt; &amp;subject, Position_ query_start, Position_ query_end, const OverlapsWithinParameters&lt; Position_ &gt; &amp;params, OverlapsWithinWorkspace&lt; Index_ &gt; &amp;workspace, std::vector&lt; Index_ &gt; &amp;matches)</div><div class="ttdef"><b>Definition</b> overlaps_within.hpp:82</div></div>
<div class="ttc" id="astructnclist_1_1OverlapsWithinParameters_html"><div class="ttname"><a href="structnclist_1_1OverlapsWithinParameters.html">nclist::OverlapsWithinParameters</a></div><div class="ttdoc">Parameters for overlaps_within().</div><div class="ttdef"><b>Definition</b> overlaps_within.hpp:45</div></div>
<div class="ttc" id="astructnclist_1_1OverlapsWithinWorkspace_html"><div class="ttname"><a href="structnclist_1_1OverlapsWithinWorkspace.html">nclist::OverlapsWithinWorkspace</a></div><div class="ttdoc">Workspace for overlaps_within().</div><div class="ttdef"><b>Definition</b> overlaps_within.hpp:25</div></div>
</div><!-- fragment --><p>Or we only care about those subject ranges with the same start position:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsStartWorkspace.html">nclist::OverlapsStartWorkspace&lt;int&gt;</a> wworkspace;</div>
<div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsStartParameters.html">nclist::OverlapsStartParameters&lt;int&gt;</a> wparams;</div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#aebdbb3bf7c28aad8d1237d030a6c97f6">nclist::overlaps_start</a>(subjects, 10, 50, wparams, wworkspace, matches);</div>
<div class="ttc" id="anamespacenclist_html_aebdbb3bf7c28aad8d1237d030a6c97f6"><div class="ttname"><a href="namespacenclist.html#aebdbb3bf7c28aad8d1237d030a6c97f6">nclist::overlaps_start</a></div><div class="ttdeci">void overlaps_start(const Nclist&lt; Index_, Position_ &gt; &amp;subject, Position_ query_start, Position_ query_end, const OverlapsStartParameters&lt; Position_ &gt; &amp;params, OverlapsStartWorkspace&lt; Index_ &gt; &amp;workspace, std::vector&lt; Index_ &gt; &amp;matches)</div><div class="ttdef"><b>Definition</b> overlaps_start.hpp:84</div></div>
<div class="ttc" id="astructnclist_1_1OverlapsStartParameters_html"><div class="ttname"><a href="structnclist_1_1OverlapsStartParameters.html">nclist::OverlapsStartParameters</a></div><div class="ttdoc">Parameters for overlaps_start().</div><div class="ttdef"><b>Definition</b> overlaps_start.hpp:48</div></div>
<div class="ttc" id="astructnclist_1_1OverlapsStartWorkspace_html"><div class="ttname"><a href="structnclist_1_1OverlapsStartWorkspace.html">nclist::OverlapsStartWorkspace</a></div><div class="ttdoc">Workspace for overlaps_start().</div><div class="ttdef"><b>Definition</b> overlaps_start.hpp:27</div></div>
</div><!-- fragment --><p>And so on. This functionality is inspired by the <code>type=</code> argument in the <code>findOverlaps()</code> function from the <b>IRanges</b> package. Note that the interpretation of some parameters (e.g., <code>max_gap</code>) depends on the type of overlap, so be sure to consult the <a href="https://ltla.github.io/nclist-cpp">relevant documentation</a>.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Templating</h1>
<p>This library will work with double-precision coordinates for the range positions:</p>
<div class="fragment"><div class="line"><span class="comment">// Again, remember that &#39;ends&#39; are not inclusive.</span></div>
<div class="line">std::vector&lt;double&gt; starts { 5.5, 10.1, 20.5 };</div>
<div class="line">std::vector&lt;double&gt; ends   { 8.5, 25.2, 30.3 };</div>
<div class="line"><span class="keyword">auto</span> subjects = <a class="code hl_function" href="namespacenclist.html#af017ae50c229346e3cf8e41599fbb5c0">nclist::build</a>(3, starts.data(), ends.data());</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsAnyWorkspace.html">nclist::OverlapsAnyWorkspace&lt;int&gt;</a> workspace;</div>
<div class="line"><a class="code hl_struct" href="structnclist_1_1OverlapsAnyParameters.html">nclist::OverlapsAnyParameters&lt;double&gt;</a> params;</div>
<div class="line">std::vector&lt;int&gt; matches;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="namespacenclist.html#ade7d2e27bd85d84a0cd210d3fcce7335">nclist::overlaps_any</a>(subjects, 14.4, 29.5, params, workspace, matches);</div>
</div><!-- fragment --><p>The subject range indices can also be changed from <code>int</code> to other integer types. Larger types may be preferred if there are more ranges than can be represented by <code>int</code>, at the cost of some increased memory usage.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Building projects</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
CMake with <code>FetchContent</code></h2>
<p>If you're using CMake, you just need to add something like this to your <code>CMakeLists.txt</code>:</p>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line"> </div>
<div class="line">FetchContent_Declare(</div>
<div class="line">  nclist</div>
<div class="line">  GIT_REPOSITORY https://github.com/LTLA/nclist</div>
<div class="line">  GIT_TAG master # or any version of interest </div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">FetchContent_MakeAvailable(nclist)</div>
</div><!-- fragment --><p>Then you can link to <b>nclist</b> to make the headers available during compilation:</p>
<div class="fragment"><div class="line"># For executables:</div>
<div class="line">target_link_libraries(myexe nclist)</div>
<div class="line"> </div>
<div class="line"># For libaries</div>
<div class="line">target_link_libraries(mylib INTERFACE nclist)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
CMake with <code>find_package()</code></h2>
<p>You can install the library by cloning a suitable version of this repository and running the following commands:</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. -DSUBPAR_TESTS=OFF</div>
<div class="line">cmake --build . --target install</div>
</div><!-- fragment --><p>Then you can use <code>find_package()</code> as usual:</p>
<div class="fragment"><div class="line">find_package(ltla_nclist CONFIG REQUIRED)</div>
<div class="line">target_link_libraries(mylib INTERFACE ltla::nclist)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
Manual</h2>
<p>If you're not using CMake, the simple approach is to just copy the files in the <code>include/</code> subdirectory - either directly or with Git submodules - and include their path during compilation with, e.g., GCC's <code>-I</code>. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
